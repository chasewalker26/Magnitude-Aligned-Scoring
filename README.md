# Attribution Quality Metrics with Magnitude Alignment
The official implementation of "Attribution Quality Metrics with Magnitude Alignment" published in IJCAI 2024
 * Official Paper - [IJCAI Link](https://www.ijcai.org/proceedings/2024/59)
 * Extended Technical Report - [GitHub Link](https://github.com/chasewalker26/Magnitude-Aligned-Scoring/blob/main/MAS_extended_technical_report.pdf)

**To cite this software please use:**
```
    @inproceedings{walker2024MAS,
      title     = {Attribution Quality Metrics with Magnitude Alignment},
      author    = {Walker, Chase and Simon, Dominic and Chen, Kenny and Ewetz, Rickard},
      booktitle = {Proceedings of the Thirty-Third International Joint Conference on
                   Artificial Intelligence, {IJCAI-24}},
      publisher = {International Joint Conferences on Artificial Intelligence Organization},
      editor    = {Kate Larson},
      pages     = {530--538},
      year      = {2024},
      month     = {8},
      note      = {Main Track},
      doi       = {10.24963/ijcai.2024/59},
      url       = {https://doi.org/10.24963/ijcai.2024/59},
    }
```
## Datasets
Place the ImageNet and RESISC45 datasets in the project root folder.

RESISC45 download: `https://1drv.ms/u/s!AmgKYzARBl5ca3HNaHIlzp_IXjs`

## How to Use the Magnitude Aligned Scoring (MAS) Metric on Attributions
See `example.ipynb` for a full example of the application of the MAS source code for multiple attributions.

It shows:
<ul>
  <li>Importing and setting up models and images for prediction.</li>
  <li>Generating attributions using integrated gradients, left integrated gradients, gradcam, guided gradcam, guided backpropagation, guided integrated gradients, and adversarial gradient integration.</li>
  <li>The class initialization and wrapper functions needed to use MAS and how to run MAS on any of the above attributions.</li>
  <li>PIC and RISE are included for comparison.</li>
</ul>

## Replicating the Paper Experiments
To replicate the paper experiments, please see the README inside of the `MAS/experiments` folder.

All experimental data reported in the paper was generated by these tests and the commands in the README.

The test results are visible in `MAS/test_results`, `MAS/noise_ignorance`, and `MAS/sensitivity_test_grapher.ipynb`.
